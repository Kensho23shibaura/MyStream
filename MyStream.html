<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vspo</title>
    <link rel="stylesheet" href="style.css?param=3.7">
    </head>
<body>
    <div class="iconArea">
      <div class="icondiv" alt="ぶいすぽ公式"><img src="images/official.jpg" class="icon" id="icon00" onclick="openLink('icon00')"></div>

      <div class="icondiv" alt="花芽すみれ"><img src="images/member01.jpg" class="icon" id="icon01" onclick="openLink('icon01')"></div>
      <div class="icondiv" alt="花芽なずな"><img src="images/member02.jpg" class="icon" id="icon02" onclick="openLink('icon02')"></div>
      <div class="icondiv" alt="小雀とと"><img src="images/member03.jpg" class="icon" id="icon03" onclick="openLink('icon03')"></div>
      <div class="icondiv" alt="一ノ瀬うるは"><img src="images/member04.jpg" class="icon" id="icon04" onclick="openLink('icon04')"></div>
      <div class="icondiv" alt="胡桃のあ"><img src="images/member05.jpg" class="icon" id="icon05" onclick="openLink('icon05')"></div>
      <div class="icondiv" alt="兎咲ミミ"><img src="images/member06.jpg" class="icon" id="icon06" onclick="openLink('icon06')"></div>
      <div class="icondiv" alt="神成きゅぴ"><img src="images/member07.jpg" class="icon" id="icon07" onclick="openLink('icon07')"></div>
      <div class="icondiv" alt="空澄セナ"><img src="images/member08.jpg" class="icon" id="icon08" onclick="openLink('icon08')"></div>
      <div class="icondiv" alt="橘ひなの"><img src="images/member09.jpg" class="icon" id="icon09" onclick="openLink('icon09')"></div>
      <div class="icondiv" alt="英リサ"><img src="images/member10.jpg" class="icon" id="icon10" onclick="openLink('icon10')"></div>
      <div class="icondiv" alt="如月れん"><img src="images/member11.jpg" class="icon" id="icon11" onclick="openLink('icon11')"></div>
      <div class="icondiv" alt="八雲べに"><img src="images/member12.jpg" class="icon" id="icon12" onclick="openLink('icon12')"></div>
      <div class="icondiv" alt="藍沢エマ"><img src="images/member13.jpg" class="icon" id="icon13" onclick="openLink('icon13')"></div>
      <div class="icondiv" alt="紫宮るな"><img src="images/member14.jpg" class="icon" id="icon14" onclick="openLink('icon14')"></div>
      <div class="icondiv" alt="猫汰つな"><img src="images/member15.jpg" class="icon" id="icon15" onclick="openLink('icon15')"></div>
      <div class="icondiv" alt="白波らむね"><img src="images/member16.jpg" class="icon" id="icon16" onclick="openLink('icon16')"></div>
      <div class="icondiv" alt="小森めと"><img src="images/member17.jpg" class="icon" id="icon17" onclick="openLink('icon17')"></div>
      <div class="icondiv" alt="夢野あかり"><img src="images/member18.jpg" class="icon" id="icon18" onclick="openLink('icon18')"></div>
      <div class="icondiv" alt="夜乃くろむ"><img src="images/member19.jpg" class="icon" id="icon19" onclick="openLink('icon19')"></div>

      <div class="icondiv" alt=""><img src="images/streamer01.jpg" class="icon" id="icon31" onclick="openLink('icon31')"></div>
      <div class="icondiv" alt=""><img src="images/streamer02.jpg" class="icon" id="icon32" onclick="openLink('icon32')"></div>
      <div class="icondiv" alt=""><img src="images/streamer03.jpg" class="icon" id="icon33" onclick="openLink('icon33')"></div>
      <div class="icondiv" alt=""><img src="images/streamer04.jpg" class="icon" id="icon34" onclick="openLink('icon34')"></div>
      <div class="icondiv" alt=""><img src="images/streamer05.jpg" class="icon" id="icon35" onclick="openLink('icon35')"></div>
      <div class="icondiv" alt=""><img src="images/streamer06.jpg" class="icon" id="icon36" onclick="openLink('icon36')"></div>
      <div class="icondiv" alt=""><img src="images/streamer07.jpg" class="icon" id="icon37" onclick="openLink('icon37')"></div>
      <div class="icondiv" alt=""><img src="images/streamer08.jpg" class="icon" id="icon38" onclick="openLink('icon38')"></div>
      <div class="icondiv" alt=""><img src="images/streamer09.jpg" class="icon" id="icon39" onclick="openLink('icon39')"></div>

    </div>
    <div class="Area">
      <div class="videoArea">
        <div id="ReplaceArea">

          <div class="big story" id="w01">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w02">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w03">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w04">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w05">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w06">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w07">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w08">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
              <iframe class="chats" src="" frameborder="0"></iframe>
          </div>
          <div class="big story" id="w09">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w10">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w11">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w12">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w13">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w14">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w15">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>
          <div class="big story" id="w16">
              <div class="clear">×</div>
              <iframe class="video" src="" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media;" allowfullscreen></iframe>
          </div>

        </div>
      </div>
      <div class="selectArea"><br>
        <img src="select/01A.png" class="select" id="select01A" title="01A" onclick="selectL('01A')">
        <img src="select/01B.png" class="select" id="select01B" title="01B" onclick="selectL('01B')"><br>
        <img src="select/02A.png" class="select" id="select02A" title="02A" onclick="selectL('02A')"><br>
        <img src="select/03A.png" class="select" id="select03A" title="03A" onclick="selectL('03A')">
        <img src="select/03B.png" class="select" id="select03B" title="03B" onclick="selectL('03B')"><br>
        <img src="select/04A.png" class="select" id="select04A" title="04A" onclick="selectL('04A')">
        <img src="select/04B.png" class="select" id="select04B" title="04B" onclick="selectL('04B')">
        <img src="select/04C.png" class="select" id="select04C" title="04C" onclick="selectL('04C')"><br>
        <img src="select/05A.png" class="select" id="select05A" title="05A" onclick="selectL('05A')">
        <img src="select/05B.png" class="select" id="select05B" title="05B" onclick="selectL('05B')">
        <img src="select/05C.png" class="select" id="select05C" title="05C" onclick="selectL('05C')"><br>
        <img src="select/06A.png" class="select" id="select06A" title="06A" onclick="selectL('06A')">
        <img src="select/06B.png" class="select" id="select06B" title="06B" onclick="selectL('06B')">
        <img src="select/06C.png" class="select" id="select06C" title="06C" onclick="selectL('06C')"><br>
        <img src="select/07A.png" class="select" id="select07A" title="07A" onclick="selectL('07A')"><br>
        <img src="select/08A.png" class="select" id="select08A" title="08A" onclick="selectL('08A')">
        <img src="select/08B.png" class="select" id="select08B" title="08B" onclick="selectL('08B')"><br>
        <img src="select/09A.png" class="select" id="select09A" title="09A" onclick="selectL('09A')">
        <img src="select/09B.png" class="select" id="select09B" title="09B" onclick="selectL('09B')"><br>
        <img src="select/10A.png" class="select" id="select10A" title="10A" onclick="selectL('10A')"><br>
        <img src="select/12A.png" class="select" id="select12A" title="12A" onclick="selectL('12A')"><br>
        <img src="select/16A.png" class="select" id="select16A" title="16A" onclick="selectL('16A')"><br>
        <button type="button" class="Check ButtonL" onclick="CheckStream()">配信チェック</button><br>
        <button type="button" class="Slide ButtonL" onclick="SlideWindow()">空窓スライド</button><br>
        <button type="button" class="Reset ButtonL" onclick="ResetWindow()">全窓リセット</button><br>
        <button type="button" class="NewFC ButtonL" onclick="NewFunction()">新規機能確認</button><br>
      </div>
    </div>

    <script>

    function CheckStream(){
      const alli = ["00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19",
                    "31","32","33","34","35","36","37","38","39"];
      alli.forEach(async (key,index)=>{
          let result = await getLink(key);
          let type = result[0];
          let text = result[1];
          let timeflag = result[2];
          var parm = window.location.search;
          //パラメータ探索
          let exsist = 0;
          if(parm.indexOf("icon"+key)!=-1){
            exsist = 1;
          }
          if((text != '')&&(type=="Y")&&(timeflag==0)){
            if(exsist==1){
              document.getElementById("icon"+key).style.border = "solid 3px rgba(177,29,44,1)";//赤
            }else{
              document.getElementById("icon"+key).style.border = "solid 3px rgba(60,179,113,1)";//緑
            }
          }else{
            if(exsist==1){
              document.getElementById("icon"+key).style.border = "solid 3px rgba(139,0,0,1)";//薄赤
            }else{
              document.getElementById("icon"+key).style.border = "solid 3px rgba(0,0,0,0.5)";//灰色
            }
          }
      });
    }
    function SlideWindow(){
      var url = new URL(window.location);

      const allw = ["w01","w02","w03","w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
      var arr = [];
      allw.forEach((wNo,index)=>{
        document.getElementById(wNo).classList.add("cleared");

        var current = new URL(window.location);
        let text = current.searchParams.get(wNo);
        if(text!=null){
          arr.push([wNo,text]);
        }
        current.searchParams.delete(document.getElementById(wNo).id);
        window.history.replaceState('','',current);

      });
      allw.forEach((wNo,index)=>{
        if(arr.length > index){
          var current = new URL(window.location);
          current.searchParams.append(wNo,arr[index][1]);
          window.history.replaceState('','',current);
        }
      });

      url = new URL(window.location);
      console.log(url);
      startWindow();
      restartWindow();

    }
    function ResetWindow(){

      //再生を停止・パラメータを削除
      const allw = ["w01","w02","w03","w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
      allw.forEach((wNo,index)=>{
        document.getElementById(wNo).getElementsByClassName("video")[0].src="";
        //document.getElementById(wNo).getElementsByClassName("video")[0].src="https://www.youtube.com/embed/1";
        document.getElementById(wNo).getElementsByClassName("video")[0].classList.add("no-content");
        try{
            document.getElementById(wNo).getElementsByClassName("chats")[0].src="";
            //document.getElementById(wNo).getElementsByClassName("chats")[0].src="https://www.youtube.com/embed/1";
            document.getElementById(wNo).getElementsByClassName("chats")[0].classList.add("no-content");
        }catch(e){}
        document.getElementById(wNo).classList.add("cleared");

        var current = new URL(window.location);
        current.searchParams.delete(document.getElementById(wNo).id);
        window.history.replaceState('','',current);
      });
      selectL('16A');
      CheckStream();

    }
    function NewFunction(){
      showAlert('更新情報','生配信中のチャンネルアイコンが緑色で表示されるようになりました!(手動更新)<br>ページの読み込み時のみ自動更新されます<br><br>全出場チームメンバーが確定しました','noClose');
    }
    function selectL(Lay){

      var current = new URL(window.location);
      current.searchParams.set("layout",Lay);
      window.history.replaceState('','',current);

      //全ての窓の余計なクラスを削除
      const all = ["w01","w02","w03","w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
      all.forEach((wNo,index)=>{
        if(document.getElementById(wNo).classList.contains('Non-Display')==true){
          document.getElementById(wNo).className="story cleared";
        }else if(document.getElementById(wNo).classList.contains('cleared')==true){
          document.getElementById(wNo).className="story cleared";
        }else{
          document.getElementById(wNo).className="story";
        }
        document.getElementById("ReplaceArea").className="grid6R7C";
      });

      let arr = [];
      let now = [];

      switch(Lay){
        case "01A"://6R7C_ok
          document.getElementById("w01").classList.add("WE01","VSE");
          arr = ["w02","w03","w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "01B"://6R7C_ok
          document.getElementById("w01").classList.add("WD01C","VSD","CSD");
          arr = ["w02","w03","w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "02A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01C","VSC","CSC");
          document.getElementById("w02").classList.add("WC03C","VSC","CSC");
          arr = ["w03","w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "03A"://6R7C_ok

          document.getElementById("w01").classList.add("WB01C","VSB","CSB");
          document.getElementById("w02").classList.add("WB04C","VSB","CSB");
          document.getElementById("w03").classList.add("WB07C","VSB","CSB");
          arr = ["w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "03B"://6R7C_ok

          document.getElementById("w01").classList.add("WC01C","VSC","CSC");
          document.getElementById("w02").classList.add("WC03","VSC");
          document.getElementById("w03").classList.add("WC04","VSC");
          arr = ["w04","w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "04A"://6R7C_ok

          document.getElementById("w01").classList.add("WA01C3","VSA","CSD");
          document.getElementById("w02").classList.add("WA05C3","VSA","CSD");
          document.getElementById("w03").classList.add("WA09C3","VSA","CSD");
          document.getElementById("w04").classList.add("WA13C3","VSA","CSD");
          arr = ["w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "04B"://6R7C_ok

          document.getElementById("w01").classList.add("WC01C","VSC","CSC");
          document.getElementById("w02").classList.add("WB07H","VSB");
          document.getElementById("w03").classList.add("WB08H","VSB");
          document.getElementById("w04").classList.add("WB09H","VSB");
          arr = ["w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "04C"://6R7C_ok

          document.getElementById("w01").classList.add("WC01","VSC");
          document.getElementById("w02").classList.add("WC02","VSC");
          document.getElementById("w03").classList.add("WC03","VSC");
          document.getElementById("w04").classList.add("WC04","VSC");
          arr = ["w05","w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "05A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01C","VSC","CSC");
          document.getElementById("w02").classList.add("WA10","VSA");
          document.getElementById("w03").classList.add("WA11","VSA");
          document.getElementById("w04").classList.add("WA14","VSA");
          document.getElementById("w05").classList.add("WA15","VSA");
          arr = ["w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "05B"://6R7C_ok

          document.getElementById("w01").classList.add("WB01C","VSB","CSB");
          document.getElementById("w02").classList.add("WB04C","VSB","CSB");
          document.getElementById("w03").classList.add("WB07","VSB");
          document.getElementById("w04").classList.add("WB08","VSB");
          document.getElementById("w05").classList.add("WB09","VSB");
          arr = ["w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "05C"://6R7C_ok

          document.getElementById("w01").classList.add("WC01","VSC");
          document.getElementById("w02").classList.add("WC02","VSC");
          document.getElementById("w03").classList.add("WB07H","VSB");
          document.getElementById("w04").classList.add("WB08H","VSB");
          document.getElementById("w05").classList.add("WB09H","VSB");
          arr = ["w06","w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "06A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01","VSC");
          document.getElementById("w02").classList.add("WC02","VSC");
          document.getElementById("w03").classList.add("WA10","VSA");
          document.getElementById("w04").classList.add("WA11","VSA");
          document.getElementById("w05").classList.add("WA14","VSA");
          document.getElementById("w06").classList.add("WA15","VSA");
          arr = ["w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "06B"://6R7C_ok?

          document.getElementById("w01").classList.add("WB01C","VSB","CSB");
          document.getElementById("w02").classList.add("WB04C","VSB","CSB");
          document.getElementById("w03").classList.add("WA13","VSA");
          document.getElementById("w04").classList.add("WA14","VSA");
          document.getElementById("w05").classList.add("WA15","VSA");
          document.getElementById("w06").classList.add("WA16","VSA");
          arr = ["w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "06C"://6R7C_ok

          document.getElementById("w01").classList.add("WB01","VSB");
          document.getElementById("w02").classList.add("WB02","VSB");
          document.getElementById("w03").classList.add("WB04","VSB");
          document.getElementById("w04").classList.add("WB05","VSB");
          document.getElementById("w05").classList.add("WB07","VSB");
          document.getElementById("w06").classList.add("WB08","VSB");
          arr = ["w07","w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "07A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01C","VSC","CSC");
          document.getElementById("w02").classList.add("WA09","VSA");
          document.getElementById("w03").classList.add("WA10","VSA");
          document.getElementById("w04").classList.add("WA11","VSA");
          document.getElementById("w05").classList.add("WA13","VSA");
          document.getElementById("w06").classList.add("WA14","VSA");
          document.getElementById("w07").classList.add("WA15","VSA");
          arr = ["w08","w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "08A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01","VSC");
          document.getElementById("w02").classList.add("WC02","VSC");
          document.getElementById("w03").classList.add("WA09","VSA");
          document.getElementById("w04").classList.add("WA10","VSA");
          document.getElementById("w05").classList.add("WA11","VSA");
          document.getElementById("w06").classList.add("WA13","VSA");
          document.getElementById("w07").classList.add("WA14","VSA");
          document.getElementById("w08").classList.add("WA15","VSA");
          arr = ["w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "08B"://6R7C_ok
          document.getElementById("w01").classList.add("WA01C1","VSA","CSA");
          document.getElementById("w02").classList.add("WA03C1","VSA","CSA");
          document.getElementById("w03").classList.add("WA05C1","VSA","CSA");
          document.getElementById("w04").classList.add("WA07C1","VSA","CSA");
          document.getElementById("w05").classList.add("WA09C1","VSA","CSA");
          document.getElementById("w06").classList.add("WA11C1","VSA","CSA");
          document.getElementById("w07").classList.add("WA13C1","VSA","CSA");
          document.getElementById("w08").classList.add("WA15C1","VSA","CSA");
          arr = ["w09","w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "09A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01C","VSC","CSC");
          document.getElementById("w02").classList.add("WA09","VSA");
          document.getElementById("w03").classList.add("WA10","VSA");
          document.getElementById("w04").classList.add("WA11","VSA");
          document.getElementById("w05").classList.add("WA12","VSA");
          document.getElementById("w06").classList.add("WA13","VSA");
          document.getElementById("w07").classList.add("WA14","VSA");
          document.getElementById("w08").classList.add("WA15","VSA");
          document.getElementById("w09").classList.add("WA16","VSA");
          arr = ["w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "09B"://6R7C_ok
          now = ["01","02","03","04","05","06","07","08","09"];
          now.forEach((wNo,index)=>{
            document.getElementById("w"+wNo).classList.add("WB"+wNo,"VSB");
          });
          arr = ["w10","w11","w12","w13","w14","w15","w16"];
          break;
        case "10A"://6R7C_ok

          document.getElementById("w01").classList.add("WC01","VSC");
          document.getElementById("w02").classList.add("WC02","VSC");
          document.getElementById("w03").classList.add("WA09","VSA");
          document.getElementById("w04").classList.add("WA10","VSA");
          document.getElementById("w05").classList.add("WA11","VSA");
          document.getElementById("w06").classList.add("WA12","VSA");
          document.getElementById("w07").classList.add("WA13","VSA");
          document.getElementById("w08").classList.add("WA14","VSA");
          document.getElementById("w09").classList.add("WA15","VSA");
          document.getElementById("w10").classList.add("WA16","VSA");
          arr = ["w11","w12","w13","w14","w15","w16"];
          break;
        case "12A"://6R7C_ok

          document.getElementById("w01").classList.add("WA01","VSA");
          document.getElementById("w02").classList.add("WA02","VSA");
          document.getElementById("w03").classList.add("WA03","VSA");
          document.getElementById("w04").classList.add("WA05","VSA");
          document.getElementById("w05").classList.add("WA06","VSA");
          document.getElementById("w06").classList.add("WA07","VSA");
          document.getElementById("w07").classList.add("WA09","VSA");
          document.getElementById("w08").classList.add("WA10","VSA");
          document.getElementById("w09").classList.add("WA11","VSA");
          document.getElementById("w10").classList.add("WA13","VSA");
          document.getElementById("w11").classList.add("WA14","VSA");
          document.getElementById("w12").classList.add("WA15","VSA");
          arr = ["w13","w14","w15","w16"];
          break;
        case "16A"://6R7C_ok
          now = ["01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16"];
          now.forEach((wNo,index)=>{
            document.getElementById("w"+wNo).classList.add("WA"+wNo,"VSA");
          });
          arr = [];
          break;
        default:
          now = [];
          arr = [];
      }

      arr.forEach((wNo,index)=>{
        //再生を停止
        document.getElementById(wNo).classList.remove("cleared");
        document.getElementById(wNo).classList.add("Non-Display");
        document.getElementById(wNo).getElementsByClassName("video")[0].src="";
        document.getElementById(wNo).getElementsByClassName("video")[0].classList.add("no-content");
        try{
            document.getElementById(wNo).getElementsByClassName("chats")[0].src="";
            document.getElementById(wNo).getElementsByClassName("chats")[0].classList.add("no-content");
        }catch(e){}

        //再生停止したアイコンの枠を変更・ボタンを有効化・パラメータを削除
        var current = new URL(window.location);
        let iNo = current.searchParams.get(wNo);
        if(iNo!=null){
          if(iNo.indexOf('icon')!=-1){
            document.getElementById(iNo).style.border = "solid 3px rgba(0,0,0,0.5)";
            //document.getElementById(iNo).style.opacity = 1.0;
          }
        }
        current.searchParams.delete(wNo);
        window.history.replaceState('','',current);

      });

    }
    async function getLink(No){

      var idList = [//Type(T:Twich Y:Youtube L:Youtube Link)
        ['Y','UCuI5XaO-6VkOEhHao6ij7JA','',''],//ぶいすぽっ!【公式】

        ['Y','UCyLGcqYs7RsBb3L0SJfzGYA','kagasumire',''],//花芽すみれ
        ['Y','UCiMG6VdScBabPhJ1ZtaVmbw','',''],//花芽なずな
        ['Y','UCgTzsBI0DIRopMylJEDqnog','',''],//小雀とと
        ['Y','UC5LyYg6cCA4yHEYvtUsir3g','uruhaichinose',''],//一ノ瀬うるは
        ['Y','UCIcAj6WkJ8vZ7DeJVgmeqKw','963noah',''],//胡桃のあ
        ['Y','UCnvVG9RbOW3J6Ifqo-zKLiw','',''],//兎咲ミミ
        ['Y','UCMp55EbT_ZlqiMS3lCj01BQ','',''],//神成きゅぴ
        ['Y','UCF_U2GCKHvDz52jWdizppIA','',''],//空澄セナ
        ['Y','UCvUc0m317LWTTPZoBQV479A','',''],//橘ひなの
        ['Y','UCurEA8YoqFwimJcAuSHU0MQ','',''],//英リサ
        ['Y','UCGWa1dMU_sDCaRQjdabsVgg','',''],//如月れん
        ['Y','UCjXBuHmWkieBApgBhDuJMMQ','',''],//八雲べに
        ['Y','UCPkKpOHxEDcwmUAnRpIu-Ng','',''],//藍沢エマ
        ['Y','UCD5W21JqNMv_tV9nfjvF9sw','',''],//紫宮るな
        ['Y','UCIjdfjcSaEgdjwbgjxC3ZWg','',''],//猫汰つな
        ['Y','UC61OwuYOVuKkpKnid-43Twg','',''],//白波らむね
        ['Y','UCzUNASdzI4PV5SlqtYwAkKQ','',''],//小森めと
        ['Y','UCS5l_Y0oMVTjEos2LuyeSZQ','',''],//夢野あかり
        ['Y','UCX4WL24YEOUYd7qDsFSLDOw','',''],//夜乃くろむ
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','','',''],//
        ['Y','UChLfthKoUV502J7gU9STArg','shibuyahal',''],//渋谷ハル
        ['Y','UCIu-aUArYq_H84dBpCAokMA','',''],//白雪レイド
        ['Y','UCbBLqA4HRowpj2JuLrkig5w','',''],//或世イヌ
        ['Y','UCuk7vapXKckSw6yCGGDspDg','',''],//緋月ゆい
        ['Y','UCZrYHIPsKhYAXqOls2kQQNQ','',''],//絲依とい
        ['Y','UC9V3Y3_uzU5e-usObb6IE1w','',''],//星川サラ
        ['Y','UCQ0UDLQCjY0rmuxCDE38FGg','',''],//夏色まつり
        ['Y','UCgYCMluaLpERsyNXlPOvBtA','kamito_jp',''],//Kamito
        ['Y','UCrWkFUu3DK5XpYBUPDC5uLA','kinapoppo',''],//kinako

        // ['Y','UCOJJ_zlt10fZqZLbGyxJUPA','',''],//トナカイト
        // ['Y','UCSZNA2IIxtb0rHcy86daUoQ','crkawase',''],//カワセ
        // ['Y','UC-o-E6I3IC2q8sAoAuM6Umg','',''],//奈羅花
        // ['Y','UCSF2vv7HFeQHrv1DinGLBLw','',''],//ハセシン

        ['Y','','','']
      ];

      var No2 = parseInt(No);
      var vType = 'Y';
      var vURL = idList[No2][3];
      var vTimeFlag = 0;

      if(vURL == ''){

        if((idList[No2][0]=='Y')&&(idList[No2][1]!='')){//Youtube
          var chID = idList[No2][1];
          console.log("searchID",chID);
          await fetch("https://script.google.com/macros/s/AKfycbyKwScR7pud64Ga8TpTKQzZtAuN3w_0qCODfXv10xQrJOVwrQmnRdkfYlWHPK1G5bjl/exec?name="+chID)
            .then(response => {
              return response.json();
            })
            .then(data => {
              vType = 'Y';
              //vURL = data.name;
              vURL = data.name.id;
              vTimeFlag = data.name.timeflag;

              if((vURL=='')&&(idList[No2][2]!='')){
                vType = "T";
                vURL = idList[No2][2];
                //オフラインチェックをいれたい
              }
              console.log("searchResult",vType,chID,vURL,vTimeFlag);

            })
            .catch(error => {
              console.log("失敗しました");
          });
        }else if(idList[No2][2]!=''){//Twitch
          console.log("searchTwitch",idList[No2][2]);
          vType = 'T';
          vURL = idList[No2][2];
          //オフラインチェックをいれたい
        }else{
          //console.log("NOTsearch");
          vType = 'Y';
          vURL = "";
        }

      }
      console.log("return",vType,vURL);
      return [vType,vURL,vTimeFlag];
    }
    async function openLink(key){

      let result = await getLink(key.replace("icon",""));
      let type = result[0];
      let text = result[1];
      console.log("openlink",type,text);
      if(text == ''){
        showAlert('視聴失敗','生配信が見つかりませんでした');
        return;
      }
      //showAlert('メンテナンス中','生配信リンクの自動取得機能が使えません');

      var url = new URL(window.location);

      //この時点でurlにiNoが存在するなら、cleared[0]じゃなくて該当する窓を指定する（違う場合の指定もここで統一？）
      //URLの更新はかけない方が安全では？（下の処理）
      //type = "M";
      //text = "10115448";

      //枠追加
      if(type=="Y"){//Youtube

        document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].classList.remove("no-content");
        document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].src="https://www.youtube.com/embed/"+text+"?autoplay=1";
        try{
          document.getElementsByClassName("cleared")[0].getElementsByClassName("chats")[0].classList.remove("no-content");
          document.getElementsByClassName("cleared")[0].getElementsByClassName("chats")[0].src="https://www.youtube.com/live_chat?v="+text+"&embed_domain="+window.location.hostname;
        }catch(e){}
        var wNo = document.getElementsByClassName("cleared")[0].id;
        document.getElementsByClassName("cleared")[0].classList.remove("cleared");

      }else if(type=="T"){//Twitch

        document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].classList.remove("no-content");
        document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].src="https://player.twitch.tv/?channel="+text+"&parent="+url.hostname;
        try{
          document.getElementsByClassName("cleared")[0].getElementsByClassName("chats")[0].classList.remove("no-content");
          document.getElementsByClassName("cleared")[0].getElementsByClassName("chats")[0].src="https://www.twitch.tv/embed/"+text+"/chat?parent="+window.location.hostname;
        }catch(e){}
        var wNo = document.getElementsByClassName("cleared")[0].id;
        document.getElementsByClassName("cleared")[0].classList.remove("cleared");

      }else{//Mildom
        document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].classList.remove("no-content");
        //document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].src="https://www.mildom.com/"+text+"&from=pcShare";//+url.hostname;
        document.getElementsByClassName("cleared")[0].getElementsByClassName("video")[0].src="https://www.mildom.com/10115448?ts=1652186403023&from=pcShare";//+url.hostname;
        var wNo = document.getElementsByClassName("cleared")[0].id;
        document.getElementsByClassName("cleared")[0].classList.remove("cleared");
      }

      var current = new URL(window.location);
      current.searchParams.append(wNo,key);
      window.history.replaceState('','',current);

      //アイコンの枠変更
      document.getElementById(key).style.border = "solid 3px rgba(177,29,44,1)";
      //document.getElementById(key).disabled = true;

      //ボタン停止・パラメータ保持

    }

    function onDragOver(event) {
      //event.stopPropagation();
      event.preventDefault();
      event.dataTransfer.dropEffect = 'link';
      console.log(event);

    }
    function onDrop(event) {
        event.preventDefault();
        var url = event.dataTransfer.getData("text");

        console.log(event);
        console.log(event.target);
        var text =event.dataTransfer.getData("text").match(/v=[^\&]*/)[0].substr(2);
        var current = new URL(window.location);
        //console.log(typeof(event.target.id));
        current.searchParams.append(event.target.id,text);
        window.history.replaceState('','',current);
        event.target.classList.remove("cleared");
        event.target.getElementsByClassName("video")[0].classList.remove("no-content");
        event.target.getElementsByClassName("video")[0].src="https://www.youtube.com/embed/"+text+"?autoplay=1";
        event.target.getElementsByClassName("chats")[0].classList.remove("no-content");
        event.target.getElementsByClassName("chats")[0].src="https://www.youtube.com/live_chat?v="+text+"&embed_domain="+window.location.hostname;

    }
    function onClickClose(event){
        //console.log(event);
        var current = new URL(window.location);
        //アイコンの状態を戻す
        current.searchParams.forEach((text,key)=>{
            console.log(text,key);
            if((key == event.target.parentNode.id)&&(text.indexOf('icon')!=-1)){
              document.getElementById(text).style.border = "solid 3px rgba(0,0,0,0.5)";
              //document.getElementById(text).style.opacity = 1.0;
            }
        });
        current.searchParams.delete(event.target.parentNode.id);
        window.history.replaceState('','',current);
        event.target.parentNode.classList.add("cleared");
        event.target.parentNode.getElementsByClassName("video")[0].src="";
        event.target.parentNode.getElementsByClassName("video")[0].classList.add("no-content");
        try{
            event.target.parentNode.getElementsByClassName("chats")[0].src="";
            event.target.parentNode.getElementsByClassName("chats")[0].classList.add("no-content");
        }catch(e){}
    }

    function startWindow(){
      //初期化
      var url = new URL(window.location);
      for(var element of document.getElementsByClassName("story")) {
          element.addEventListener("dragover",onDragOver,true);
          element.addEventListener("drop",onDrop,true);
          element.querySelector(".clear").addEventListener("click",onClickClose);
          element.classList.add("cleared");
          element.getElementsByClassName("video")[0].src="";
          element.getElementsByClassName("video")[0].classList.add("no-content");
          try{
              element.getElementsByClassName("chats")[0].src="";
              element.getElementsByClassName("chats")[0].classList.add("no-content");
          }catch(e){}
      }
    }
    function restartWindow(){
      //パラメータ修復
      var url = new URL(window.location);
      selectL('16A');
      let type = 'Y';
      url.searchParams.forEach(async (text,key)=>{
          if(key.indexOf('layout')!=-1){
            selectL(text);
            return;
          }else if(text.indexOf('icon')!=-1){
            let key = text;
            let result = await getLink(key);
            type = result[0];
            text = result[1];
            // //ここで空っぽの場合continue?→それをやるとパラメータ消すのめんどくさい
            // if(text == ''){
            //   showAlert('視聴失敗','生配信が見つかりませんでした');
            //   continue;
            // }
            // console.log("rs",result,type,text);
            document.getElementById(key).style.border = "solid 3px rgba(177,29,44,1)";
            //document.getElementById(key).style.opacity = 0.8;
          }

          var target = document.getElementById(key);
          //枠追加
          if(type=="Y"){//Youtube

            target.getElementsByClassName("video")[0].classList.remove("no-content");
            target.getElementsByClassName("video")[0].src="https://www.youtube.com/embed/"+text+"?autoplay=1";
            try{
              target.getElementsByClassName("chats")[0].classList.remove("no-content");
              target.getElementsByClassName("chats")[0].src="https://www.youtube.com/live_chat?v="+text+"&embed_domain="+window.location.hostname;
            }catch(e){}
            var wNo = target.id;
            target.classList.remove("cleared");

          }else if(type=="T"){//Twitch

            target.getElementsByClassName("video")[0].classList.remove("no-content");
            target.getElementsByClassName("video")[0].src="https://player.twitch.tv/?channel="+text+"&parent="+url.hostname;
            var wNo = target.id;
            target.classList.remove("cleared");

          }

      });
    }

    startWindow();
    restartWindow();
    CheckStream();
    //showAlert('メンテナンス中','生配信リンクの自動取得機能が使えません');

    //ここからバナーとアラート・ポップアップ
    /*
    -----使い方----
    banner(title,text [,detail]);
      >>バナーを使う（バナーは10秒で自動的に消える）
        title(String) :バナーのタイトル
        text(String)  :バナーの内容、タグの使用可能
        detail(String):省略可、バナータッチ時に表示するポップアップの本文、タグの使用可能.

        Ex.)　banner("test","これはテスト","これはテストです。");

    showAlert(title,txt[,popup[,fn])
      >>ポップアップを使う。Okを押さなくても100秒後に閉じる
      title(String) :ポップアップのタイトル
      txt(String)   :バナーの内容、タグの使用可能
      popup(String) :省略可、デフォルトはhidden.

        -hidden  デフォルト値. 100秒で自動的に閉じるアラート。OKボタンのみある。fnを実行する。
        -noClose 自動的には閉じないアラート。OKボタンのみある。fnを実行する。
        -その他   自動的に閉じないコンファーム。キャンセルを押すと何もしない、OKを押すとfnを実行する

      fn(String)    :省略可。関数名もしくは function(){} を直接記述。OKを押した後に実行される。' or " で囲む必要あり。

      Ex.)　showAlert('テストです','このコンファームはテストです。','confirm','banner("やったー","コンファームが無事使えたよ！")');
            showAlert('テスト','自動的に消えます。');

    */
    //ここからバナー
    function banner(title,text,detail = text){
      var div = document.createElement('div');
      div.className = "banner";
      div.setAttribute("onclick","this.style.animation='animation-banner-up 0.5s';showAlert('"+title+"','"+detail+"','noClose')");
      var h1 = document.createElement('h2');
      h1.innerHTML = title;
      var p = document.createElement('p');
      p.innerHTML = text;
      div.appendChild(h1);
      div.appendChild(p);
      document.getElementsByTagName('body')[0].appendChild(div);
    }

    //ここからアラート
    function showAlert(title,txt,popup="hidden",fn=function(){}){
      //タイトル、本文、(デフォルト=10秒閉じ,noClose=自動で閉じないアラート,その他＝confirm),関数ー＞""で囲む,Okayに渡される
      var div1 = document.createElement('div');
      div1.className = "bgAlert";
      var div2 = document.createElement('div');
      div2.className = "alert";
      var h2 = document.createElement('h2');
      h2.innerHTML = title;
      var p = document.createElement('p');
      p.innerHTML = txt;
      var time = document.createElement('div');
      time.innerHTML = "Auto Close : 10 sec.";
      var cancel = document.createElement('button');
      cancel.innerHTML = "キャンセル";
      cancel.setAttribute("onclick","hideConfirm(this);");
      if(popup==("hidden"))cancel.style.visibility="hidden";
      if(popup==("noClose"))cancel.style.visibility="hidden";
      var okay = document.createElement('button');
      okay.style.background = "#5566FF";
      //
      okay.setAttribute("onclick","hideConfirm(this,"+fn+");");
      okay.innerHTML  = "OK";
      div2.appendChild(h2);
      div2.appendChild(p);
      div2.appendChild(cancel);
      div2.appendChild(okay);
      div1.appendChild(div2);
      document.getElementsByTagName('body')[0].appendChild(div1);
      if(popup=="hidden"){
        div2.appendChild(time);
        console.log(time.innerHTML.replace(/[^0-9]/g,""));
        var timeout = setInterval(function(time){time.innerHTML = "Auto Close : "+(parseInt(time.innerHTML.replace(/[^0-9]/g,""))-1)+" sec.";},1000,time);
        setTimeout(function(div1,timeout){clearInterval(timeout);console.log(div1);div1.remove(div1);},11000,div1,timeout);
      }
    }
    function hideConfirm(obj,fc=function(){}){
      obj.parentNode.parentNode.style.display='none';
      fc();
    }


    </script>
</body>
</html>
